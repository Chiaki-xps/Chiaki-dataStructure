# 红黑树（Red-black tree）

+ 红黑树是一种**自平衡二叉搜索树**。最早叫对称二叉B树。

+ 红黑树除了符合二叉搜索树的基本规则外，还添加了一些特性：
  1. 节点是红色或黑色（早期计算机显示颜色的原因选用黑色和红色，AVL树给每一个节点一个权值(通过权值判断是否平衡)，RB树给每一个节点一个颜色）
  
  2. 根节点是黑色
  
  3. 每个叶子节点都是黑色的空节点（NIL节点，空节点）。（可以理解成最后都必须指向null，最后一层都是null）
     + 第三条性质要求每个叶子节点（空节点）是黑色的。	（目的是从黑色节点出发，结尾一定也是一个黑色节点）
     + 这是因为在红黑树中，黑色节点的数量表示从根节点到叶子节点的黑色节点数量
  
  4. 每个红色节点的两个字节点都是黑色。（从每个叶子到根的所有路径上不能有两个连续的红色节点）
     + 第四条性质保证了红色节点的颜色不会影响树的平衡，同时保证了红色节点的出现不会导致连续的红色节点。
  5. 从任一节点到其每个叶子的所有路径都包含相同数目的黑色节点。（一个黑色节点出发到任意一个叶子节点的路径上，黑色节点数量一定是相同的）
     + 第五条性质是最重要的性质，保证了红黑树的平衡性。（前面的四个性质最终为了服务第五条）

## 红黑树的相对平衡

+ 前面的性质约束，确保了红黑树的关键特性:
  + 从根到叶子节点的最长可能路径，不会超过最短可能路径的两倍长。（AVL树相差不能为1，所以很明显红黑树没有AVL树平衡，不超过两倍，不平衡也是ok的）
  + 结果就是这个树是基本平衡的
  + 虽然没有做到绝对的平衡，但是可以保证在最坏的情况下，依然是高效的。 

+ 为什么可以做到**最长路径不超过最短路径的两倍**呢？
  + 性质五决定了最短路径和最长路径必须有相同的黑色节点；
  + 路径最短的情况: 全部都是黑色节点（假设数量为n）；
  + 路径最长的情况: 黑色节点的数量也是n（根据性质5推导出来），中间红色节点为n-1。因为根节点是黑色，尾节点是黑色，红黑交替。
    + 性质二：根节点是黑节点
    + 性质三：叶子节点都是黑节点
    + 性质四：两个红色节点不能相连
  + 路径是计算边的数量（节点数量 -1）：所以最短路径为n-1，
  + 最长路径为（n + n -1） -1 = 2n -2
  + 所以最长路径一定不超过最短路径的2倍
+ 题外话：加入不理解为什么这么设计的话，就当作游戏规则，这个红黑树的游戏规则有这五条，通过这五条得出一些规律。

![image-20230804230951535](红黑树.assets/image-20230804230951535.png)

![image-20230804223514289](红黑树.assets/image-20230804223514289.png)

## 红黑树的性能分析

+ 为什么已经有平衡二叉树，还需要红黑树？

+ 事实上，红黑树的性能在搜索上是不如AVL树的，为什么呢？

![image-20230804233807468](红黑树.assets/image-20230804233807468.png)

插入和删除的时候，红黑树对平衡的要求不高，所以减少了性能消耗

但是搜索上，AVL树性能更佳。

![image-20230804234738031](红黑树.assets/image-20230804234738031.png)

+ 用红黑树用的多是因为综合效率更高。





## x. 图包

![image-20230804223805728](红黑树.assets/image-20230804223805728.png)

![image-20230804231348751](红黑树.assets/image-20230804231348751.png)

![image-20230804232516863](红黑树.assets/image-20230804232516863.png)

![image-20230804233814591](红黑树.assets/image-20230804233814591.png)

![image-20230804234734276](红黑树.assets/image-20230804234734276.png)













## x1. 红黑树代码

![image-20230719104420081](红黑树.assets/image-20230719104420081.png)

![image-20230719104428498](红黑树.assets/image-20230719104428498.png)

![image-20230719104440344](红黑树.assets/image-20230719104440344.png)

![image-20230719104448689](红黑树.assets/image-20230719104448689.png)

![image-20230719104455011](红黑树.assets/image-20230719104455011.png)

![image-20230719104506469](红黑树.assets/image-20230719104506469.png)

![image-20230719104551289](红黑树.assets/image-20230719104551289.png)

![image-20230719104620578](红黑树.assets/image-20230719104620578.png)

![image-20230719104633493](红黑树.assets/image-20230719104633493.png)

![image-20230719104651592](红黑树.assets/image-20230719104651592.png)

![image-20230719104718793](红黑树.assets/image-20230719104718793.png)

 ![image-20230719104733141](红黑树.assets/image-20230719104733141.png)

![image-20230719104800777](红黑树.assets/image-20230719104800777.png)

![image-20230719105315061](红黑树.assets/image-20230719105315061.png)

![image-20230719105731432](红黑树.assets/image-20230719105731432.png)

![image-20230719105308870](红黑树.assets/image-20230719105308870.png)

![image-20230719105407486](红黑树.assets/image-20230719105407486.png)

![image-20230719105425549](红黑树.assets/image-20230719105425549.png)



















 

















